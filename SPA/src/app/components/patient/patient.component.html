<div class="text-center">
  <h1 class="fw-bold mt-2 main-title mb-4">
    Patient
    <p-button icon="pi pi-plus" class="me-3 ms-3" (click)="openCreateModal()"
    />
  </h1>
</div>

<div class="container">
  <p-table [value]="filteredPatientList" styleClass="p-datatable-striped" [tableStyle]="{ 'min-width': '20rem' }">
    <ng-template pTemplate="header">
      <tr>
        <th>
          <p-columnFilter type="text" field="fullName" placeholder="Search by name" ariaLabel="Filter Name"
            [matchModeOptions]="matchModeOptions" matchMode="contains" />
        </th>
        <th>
          <p-columnFilter type="text" field="email" placeholder="Search by email" ariaLabel="Filter Email"
            [matchModeOptions]="matchModeOptions" matchMode="contains" />
        </th>
        <th>
          <p-columnFilter type="text" field="dateOfBirth" placeholder="Search by date of birth"
            ariaLabel="Filter Date of Birth" [matchModeOptions]="matchModeOptions" matchMode="contains" />
        </th>
        <th></th>
      </tr>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Date of Birth</th>
        <th></th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-patient>
      <tr>
        <td>{{ patient.fullName }}</td>
        <td>{{ patient.email }}</td>
        <td>{{ patient.dateOfBirth | date:'dd/MM/yyyy' }}</td>
        <td class="text-center">
          <p-button icon="pi pi-eye" class="me-3" [rounded]="true" [text]="true" (click)="openDetailsModal(patient)" />
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<p-dialog
  header="Patient"
  [(visible)]="showCreate"
  [modal]="true"
  [style]="{ width: '50vw' }"
  [draggable]="false"
  [resizable]="false"
>
  <ng-template pTemplate="header">
    <h4 class="fw-bold">Create Patient Profile</h4>
  </ng-template>

  <form>


    
  </form>
</p-dialog>

<p-dialog header="Patient Details" [(visible)]="showDetails" [modal]="true" [style]="{ width: '50vw' }"
  [draggable]="false" [resizable]="false">
  <ng-template pTemplate="header">
    <h4 class="fw-bold">{{ currentPatient?.fullName }}</h4>
  </ng-template>
  <div class="container">
    <!-- General Information Section -->
    <h5 class="title-separator separator">General Information</h5>
    <hr class="line-separator separator" />
    <div class="row">
      <label for="fullName"><b>Full Name:</b> {{ currentPatient?.fullName }}</label>
      <label for="dateOfBirth" class="mt-2"><b>Date of Birth:</b> {{ currentPatient?.dateOfBirth | date:'dd/MM/yyyy' }}</label>
      <label for="gender" class="mt-2"><b>Gender:</b> {{ currentPatient?.gender }}</label>
      <label for="medicalRecordNumber" class="mt-2"><b>Medical Record Number:</b> {{ currentPatient?.medicalRecordNumber }}</label>
    </div>

    <!-- Contact Information Section -->
    <h5 class="title-separator separator mt-4">Contact Information</h5>
    <hr class="line-separator separator" />
    <div class="row">
      <label for="phone"><b>Phone:</b> {{ currentPatient?.phone }}</label>
      <label for="email" class="mt-2"><b>Email:</b> {{ currentPatient?.email }}</label>
      <label for="emergencyContact" class="mt-2"><b>Emergency Contact:</b> {{ currentPatient?.emergencyContact }}</label>
    </div>

    <!-- Medical Information Section (Optional) -->
    <h5 class="title-separator separator mt-4">Medical Information</h5>
    <hr class="line-separator separator" />
    <div class="row">
      <label for="allergies" class="mt-2"><b>Allergies:</b> 
        <span *ngIf="currentPatient?.allergies && currentPatient.allergies.length > 0">
          {{ currentPatient?.allergies.join(', ') }}
        </span>
        <span *ngIf="!currentPatient?.allergies || currentPatient.allergies.length === 0">None</span>
      </label>
    </div>
  </div>
</p-dialog>

